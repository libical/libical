<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Libical API Documentation: icalmemory.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Libical API Documentation<span id="projectnumber">&#160;4.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b7a0ea939f6e83384f3c571d31a84be9.html">libical</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="summary">
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">icalmemory.h File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Common memory management routines.  
<a href="#details">More...</a></p>

<p><a href="icalmemory_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="typedef-members" name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a996b3b0b54aed95641e212bd9e0c6ae5" id="r_a996b3b0b54aed95641e212bd9e0c6ae5"><td class="memItemLeft" align="right" valign="top"><a id="a996b3b0b54aed95641e212bd9e0c6ae5" name="a996b3b0b54aed95641e212bd9e0c6ae5"></a>
typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><b>icalmemory_free_f</b>) (void *)</td></tr>
<tr class="separator:a996b3b0b54aed95641e212bd9e0c6ae5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ea138c477dcd2ca3d2a7eaa7cb68de4" id="r_a6ea138c477dcd2ca3d2a7eaa7cb68de4"><td class="memItemLeft" align="right" valign="top"><a id="a6ea138c477dcd2ca3d2a7eaa7cb68de4" name="a6ea138c477dcd2ca3d2a7eaa7cb68de4"></a>
typedef void *(*&#160;</td><td class="memItemRight" valign="bottom"><b>icalmemory_malloc_f</b>) (size_t)</td></tr>
<tr class="separator:a6ea138c477dcd2ca3d2a7eaa7cb68de4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88463c5fd869f65b1a8cc1bc0a166244" id="r_a88463c5fd869f65b1a8cc1bc0a166244"><td class="memItemLeft" align="right" valign="top"><a id="a88463c5fd869f65b1a8cc1bc0a166244" name="a88463c5fd869f65b1a8cc1bc0a166244"></a>
typedef void *(*&#160;</td><td class="memItemRight" valign="bottom"><b>icalmemory_realloc_f</b>) (void *, size_t)</td></tr>
<tr class="separator:a88463c5fd869f65b1a8cc1bc0a166244"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae9f1799733a1577748a028181098be48" id="r_ae9f1799733a1577748a028181098be48"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae9f1799733a1577748a028181098be48">icalmemory_add_tmp_buffer</a> (void *buf)</td></tr>
<tr class="memdesc:ae9f1799733a1577748a028181098be48"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds an externally allocated buffer to the ring.  <br /></td></tr>
<tr class="separator:ae9f1799733a1577748a028181098be48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addac122edb16bc41a193895c86bd5ff5" id="r_addac122edb16bc41a193895c86bd5ff5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#addac122edb16bc41a193895c86bd5ff5">icalmemory_append_char</a> (char **buf, char **pos, size_t *buf_size, char ch)</td></tr>
<tr class="memdesc:addac122edb16bc41a193895c86bd5ff5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Appends a character to a buffer.  <br /></td></tr>
<tr class="separator:addac122edb16bc41a193895c86bd5ff5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a647bf5dab81fc5b83a0ed8f8ad769ea6" id="r_a647bf5dab81fc5b83a0ed8f8ad769ea6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a647bf5dab81fc5b83a0ed8f8ad769ea6">icalmemory_append_string</a> (char **buf, char **pos, size_t *buf_size, const char *string)</td></tr>
<tr class="memdesc:a647bf5dab81fc5b83a0ed8f8ad769ea6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Appends a string to a buffer.  <br /></td></tr>
<tr class="separator:a647bf5dab81fc5b83a0ed8f8ad769ea6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f164cb87c67f06b5dc04a5f21384879" id="r_a2f164cb87c67f06b5dc04a5f21384879"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a2f164cb87c67f06b5dc04a5f21384879">icalmemory_free_buffer</a> (void *buf)</td></tr>
<tr class="memdesc:a2f164cb87c67f06b5dc04a5f21384879"><td class="mdescLeft">&#160;</td><td class="mdescRight">Releases a buffer.  <br /></td></tr>
<tr class="separator:a2f164cb87c67f06b5dc04a5f21384879"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a175daa67f089bae6aefd4360fcd0d664" id="r_a175daa67f089bae6aefd4360fcd0d664"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a175daa67f089bae6aefd4360fcd0d664">icalmemory_free_ring</a> (void)</td></tr>
<tr class="memdesc:a175daa67f089bae6aefd4360fcd0d664"><td class="mdescLeft">&#160;</td><td class="mdescRight">Frees all memory used in the ring.  <br /></td></tr>
<tr class="separator:a175daa67f089bae6aefd4360fcd0d664"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1659b63eaac2744cae912c727655721" id="r_ae1659b63eaac2744cae912c727655721"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae1659b63eaac2744cae912c727655721">icalmemory_get_mem_alloc_funcs</a> (icalmemory_malloc_f *f_malloc, icalmemory_realloc_f *f_realloc, icalmemory_free_f *f_free)</td></tr>
<tr class="memdesc:ae1659b63eaac2744cae912c727655721"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the functions used for memory management.  <br /></td></tr>
<tr class="separator:ae1659b63eaac2744cae912c727655721"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b645edbcc1a05dbb64df5d86adbc367" id="r_a9b645edbcc1a05dbb64df5d86adbc367"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a9b645edbcc1a05dbb64df5d86adbc367">icalmemory_new_buffer</a> (size_t size)</td></tr>
<tr class="memdesc:a9b645edbcc1a05dbb64df5d86adbc367"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates new buffer with the specified size.  <br /></td></tr>
<tr class="separator:a9b645edbcc1a05dbb64df5d86adbc367"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cf9578649d6f12bf8eae97e4ef537e9" id="r_a6cf9578649d6f12bf8eae97e4ef537e9"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a6cf9578649d6f12bf8eae97e4ef537e9">icalmemory_resize_buffer</a> (void *buf, size_t size)</td></tr>
<tr class="memdesc:a6cf9578649d6f12bf8eae97e4ef537e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Resizes a buffer created with <a class="el" href="#a9b645edbcc1a05dbb64df5d86adbc367" title="Creates new buffer with the specified size.">icalmemory_new_buffer()</a>.  <br /></td></tr>
<tr class="separator:a6cf9578649d6f12bf8eae97e4ef537e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaa82604d4c5ccf150ecd2fb6bfca30d" id="r_aeaa82604d4c5ccf150ecd2fb6bfca30d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeaa82604d4c5ccf150ecd2fb6bfca30d">icalmemory_set_mem_alloc_funcs</a> (icalmemory_malloc_f f_malloc, icalmemory_realloc_f f_realloc, icalmemory_free_f f_free)</td></tr>
<tr class="memdesc:aeaa82604d4c5ccf150ecd2fb6bfca30d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configures the functions to use for memory management.  <br /></td></tr>
<tr class="separator:aeaa82604d4c5ccf150ecd2fb6bfca30d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a313a5fd91cb6100f9ecc1b8f24acc336" id="r_a313a5fd91cb6100f9ecc1b8f24acc336"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a313a5fd91cb6100f9ecc1b8f24acc336">icalmemory_strdup</a> (const char *s)</td></tr>
<tr class="memdesc:a313a5fd91cb6100f9ecc1b8f24acc336"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a duplicate of a string.  <br /></td></tr>
<tr class="separator:a313a5fd91cb6100f9ecc1b8f24acc336"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaf6a28b3908f695bb0a7e35d1dfc8f7" id="r_aeaf6a28b3908f695bb0a7e35d1dfc8f7"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aeaf6a28b3908f695bb0a7e35d1dfc8f7">icalmemory_tmp_buffer</a> (size_t size)</td></tr>
<tr class="memdesc:aeaf6a28b3908f695bb0a7e35d1dfc8f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a new temporary buffer on the ring and returns it.  <br /></td></tr>
<tr class="separator:aeaf6a28b3908f695bb0a7e35d1dfc8f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5f6b34db6cc88a33bd1cd745d44f977" id="r_aa5f6b34db6cc88a33bd1cd745d44f977"><td class="memItemLeft" align="right" valign="top">char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aa5f6b34db6cc88a33bd1cd745d44f977">icalmemory_tmp_copy</a> (const char *str)</td></tr>
<tr class="memdesc:aa5f6b34db6cc88a33bd1cd745d44f977"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a copy of the given string, stored on the ring buffer, and returns it.  <br /></td></tr>
<tr class="separator:aa5f6b34db6cc88a33bd1cd745d44f977"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Common memory management routines. </p>
<p>libical often passes strings back to the caller. To make these interfaces simple, I did not want the caller to have to pass in a memory buffer, but having libical pass out newly allocated memory makes it difficult to de-allocate the memory.</p>
<p>The ring buffer in this scheme makes it possible for libical to pass out references to memory which the caller does not own, and be able to de-allocate the memory later. The ring allows libical to have several buffers active simultaneously, which is handy when creating string representations of components. Methods for working with these temporary buffers are marked with <code>icalmemory_tmp_*()</code>.</p>
<p>Other memory management routines include wrappers around the system management routines like <a class="el" href="#a9b645edbcc1a05dbb64df5d86adbc367" title="Creates new buffer with the specified size.">icalmemory_new_buffer()</a> and <a class="el" href="#a2f164cb87c67f06b5dc04a5f21384879" title="Releases a buffer.">icalmemory_free_buffer()</a> as well as routines to work with strings, like <a class="el" href="#a647bf5dab81fc5b83a0ed8f8ad769ea6" title="Appends a string to a buffer.">icalmemory_append_string()</a>. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="ae9f1799733a1577748a028181098be48" name="ae9f1799733a1577748a028181098be48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9f1799733a1577748a028181098be48">&#9670;&#160;</a></span>icalmemory_add_tmp_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void icalmemory_add_tmp_buffer </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adds an externally allocated buffer to the ring. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>The externally allocated buffer to add to the ring</td></tr>
  </table>
  </dd>
</dl>
<p>Adds an externally allocated buffer to the ring. This ensures that libical will <code>free()</code> the buffer automatically, either after BUFFER_RING_SIZE other buffers have been created or added, or after <a class="el" href="#a175daa67f089bae6aefd4360fcd0d664" title="Frees all memory used in the ring.">icalmemory_free_ring()</a> has been called. Note that freeing the buffers is done using the <a class="el" href="#a2f164cb87c67f06b5dc04a5f21384879" title="Releases a buffer.">icalmemory_free_buffer()</a> function, which by default is a wrapper around stdlib's free() function. However, if the memory management functions are customized by the user, the user must make sure to only pass in buffers that have been allocated in a compatible manner.</p>
<dl class="section user"><dt>Error handling</dt><dd>No error is raised if <em class="arg">buf</em> is <code>NULL</code>.</dd></dl>
<dl class="section user"><dt>Ownership</dt><dd>After adding <em class="arg">buf</em> to the ring, it becomes owned by icalmemory and must not be <code>free()</code>d manually anymore, it leads to a double-<code>free()</code> when icalmemory reclaims the memory.</dd></dl>
<dl class="section user"><dt>Usage</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">char</span> *buf = calloc(256, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="#ae9f1799733a1577748a028181098be48">icalmemory_add_tmp_buffer</a>(buf);</div>
<div class="ttc" id="aicalmemory_8h_html_ae9f1799733a1577748a028181098be48"><div class="ttname"><a href="#ae9f1799733a1577748a028181098be48">icalmemory_add_tmp_buffer</a></div><div class="ttdeci">void icalmemory_add_tmp_buffer(void *buf)</div><div class="ttdoc">Adds an externally allocated buffer to the ring.</div><div class="ttdef"><b>Definition</b> icalmemory.c:167</div></div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="addac122edb16bc41a193895c86bd5ff5" name="addac122edb16bc41a193895c86bd5ff5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addac122edb16bc41a193895c86bd5ff5">&#9670;&#160;</a></span>icalmemory_append_char()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void icalmemory_append_char </td>
          <td>(</td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>pos</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>buf_size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char</td>          <td class="paramname"><span class="paramname"><em>ch</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Appends a character to a buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>The buffer to append the character to. </td></tr>
    <tr><td class="paramname">pos</td><td>The position to append the character at. </td></tr>
    <tr><td class="paramname">buf_size</td><td>The size of the buffer (will be changed if buffer is reallocated) </td></tr>
    <tr><td class="paramname">ch</td><td>The character to append to the buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>This method may not be used for temporary buffers (buffers allocated with <a class="el" href="#aeaf6a28b3908f695bb0a7e35d1dfc8f7" title="Creates a new temporary buffer on the ring and returns it.">icalmemory_tmp_buffer()</a> and related functions)!</dd></dl>
<dl class="section user"><dt>Error handling</dt><dd>Sets <a class="el" href="icalerror_8h.html#ad2562706150f5c5a4d9b0ca149d78e37" title="Access the current icalerrno value.">icalerrno</a> to <a class="el" href="icalerror_8h.html#a601c122fcea522513b1b7732fa23e833a2cc8bbcd8c07fc9a16e36f7aae5757b1">ICAL_BADARG_ERROR</a> if <em class="arg">buf</em>, <code>*buf</code>, <em class="arg">pos</em>, <code>* pos</code>, or <em class="arg">buf_size</em> <code>NULL</code>.</dd></dl>
<p>This method will copy the character <em class="arg">ch</em> and a &lsquo;&rsquo;\0'<code>character after it to the buffer @a buf starting at position @a pos, reallocing @a buf if it is too small. @a buf_size is the size of @a buf and will be changed if @a buf is reallocated. @a pos will point to the new terminating</code>'\0'` character <em class="arg">buf</em>.</p>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><span class="comment">// creates a new buffer</span></div>
<div class="line"><span class="keywordtype">int</span> buffer_len = 15;</div>
<div class="line"><span class="keywordtype">char</span> *buffer = <a class="code hl_function" href="#a9b645edbcc1a05dbb64df5d86adbc367">icalmemory_new_buffer</a>(buffer_len);</div>
<div class="line">strcpy(buffer, <span class="stringliteral">&quot;My number is: &quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// append a char to the buffer</span></div>
<div class="line"><span class="keywordtype">int</span> buffer_end = strlen(buffer);</div>
<div class="line"><span class="keywordtype">char</span> *buffer_end_pos = buffer[buffer_str_end];</div>
<div class="line"><a class="code hl_function" href="#addac122edb16bc41a193895c86bd5ff5">icalmemory_append_char</a>(&amp;buffer, &amp;buffer_end_pos, &amp;buffer_len, <span class="charliteral">&#39;7&#39;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// print string</span></div>
<div class="line">printf(<span class="stringliteral">&quot;%s\n&quot;</span>, buffer);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// release memory</span></div>
<div class="line"><a class="code hl_function" href="#a2f164cb87c67f06b5dc04a5f21384879">icalmemory_free_buffer</a>(buffer);</div>
<div class="ttc" id="aicalmemory_8h_html_a2f164cb87c67f06b5dc04a5f21384879"><div class="ttname"><a href="#a2f164cb87c67f06b5dc04a5f21384879">icalmemory_free_buffer</a></div><div class="ttdeci">void icalmemory_free_buffer(void *buf)</div><div class="ttdoc">Releases a buffer.</div><div class="ttdef"><b>Definition</b> icalmemory.c:360</div></div>
<div class="ttc" id="aicalmemory_8h_html_a9b645edbcc1a05dbb64df5d86adbc367"><div class="ttname"><a href="#a9b645edbcc1a05dbb64df5d86adbc367">icalmemory_new_buffer</a></div><div class="ttdeci">void * icalmemory_new_buffer(size_t size)</div><div class="ttdoc">Creates new buffer with the specified size.</div><div class="ttdef"><b>Definition</b> icalmemory.c:320</div></div>
<div class="ttc" id="aicalmemory_8h_html_addac122edb16bc41a193895c86bd5ff5"><div class="ttname"><a href="#addac122edb16bc41a193895c86bd5ff5">icalmemory_append_char</a></div><div class="ttdeci">void icalmemory_append_char(char **buf, char **pos, size_t *buf_size, char ch)</div><div class="ttdoc">Appends a character to a buffer.</div><div class="ttdef"><b>Definition</b> icalmemory.c:411</div></div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="a647bf5dab81fc5b83a0ed8f8ad769ea6" name="a647bf5dab81fc5b83a0ed8f8ad769ea6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a647bf5dab81fc5b83a0ed8f8ad769ea6">&#9670;&#160;</a></span>icalmemory_append_string()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void icalmemory_append_string </td>
          <td>(</td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **</td>          <td class="paramname"><span class="paramname"><em>pos</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t *</td>          <td class="paramname"><span class="paramname"><em>buf_size</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>string</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Appends a string to a buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>The buffer to append the string to. </td></tr>
    <tr><td class="paramname">pos</td><td>The position to append the string at. </td></tr>
    <tr><td class="paramname">buf_size</td><td>The size of the buffer (will be changed if buffer is reallocated) </td></tr>
    <tr><td class="paramname">string</td><td>The string to append to the buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>This method may not be used for temporary buffers (buffers allocated with <a class="el" href="#aeaf6a28b3908f695bb0a7e35d1dfc8f7" title="Creates a new temporary buffer on the ring and returns it.">icalmemory_tmp_buffer()</a> and related functions)!</dd></dl>
<dl class="section user"><dt>Error handling</dt><dd>Sets <a class="el" href="icalerror_8h.html#ad2562706150f5c5a4d9b0ca149d78e37" title="Access the current icalerrno value.">icalerrno</a> to <a class="el" href="icalerror_8h.html#a601c122fcea522513b1b7732fa23e833a2cc8bbcd8c07fc9a16e36f7aae5757b1">ICAL_BADARG_ERROR</a> if <em class="arg">buf</em>, <code>*buf</code>, <em class="arg">pos</em>, <code>* pos</code>, <em class="arg">buf_size</em> or <em class="arg">string</em> are <code>NULL</code>.</dd></dl>
<p>This method will copy the string <em class="arg">string</em> to the buffer <em class="arg">buf</em> starting at position <em class="arg">pos</em>, reallocing <em class="arg">buf</em> if it is too small. <em class="arg">buf_size</em> is the size of <em class="arg">buf</em> and will be changed if <em class="arg">buf</em> is reallocated. <em class="arg">pos</em> will point to the last byte of the new string in <em class="arg">buf</em>, usually a &lsquo;&rsquo;\0'`</p>
<dl class="section user"><dt>Example</dt><dd><div class="fragment"><div class="line"><span class="comment">// creates a new buffer</span></div>
<div class="line"><span class="keywordtype">int</span> buffer_len = 15;</div>
<div class="line"><span class="keywordtype">char</span> *buffer = <a class="code hl_function" href="#a9b645edbcc1a05dbb64df5d86adbc367">icalmemory_new_buffer</a>(buffer_len);</div>
<div class="line">strcpy(buffer, <span class="stringliteral">&quot;My name is: &quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// append a string to the buffer</span></div>
<div class="line"><span class="keywordtype">int</span> buffer_end = strlen(buffer);</div>
<div class="line"><span class="keywordtype">char</span> *buffer_end_pos = buffer[buffer_str_end];</div>
<div class="line"><a class="code hl_function" href="#a647bf5dab81fc5b83a0ed8f8ad769ea6">icalmemory_append_string</a>(&amp;buffer, &amp;buffer_end_pos, &amp;buffer_len, <span class="stringliteral">&quot;John Doe&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// print string</span></div>
<div class="line">printf(<span class="stringliteral">&quot;%s\n&quot;</span>, buffer);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// release memory</span></div>
<div class="line"><a class="code hl_function" href="#a2f164cb87c67f06b5dc04a5f21384879">icalmemory_free_buffer</a>(buffer);</div>
<div class="ttc" id="aicalmemory_8h_html_a647bf5dab81fc5b83a0ed8f8ad769ea6"><div class="ttname"><a href="#a647bf5dab81fc5b83a0ed8f8ad769ea6">icalmemory_append_string</a></div><div class="ttdeci">void icalmemory_append_string(char **buf, char **pos, size_t *buf_size, const char *string)</div><div class="ttdoc">Appends a string to a buffer.</div><div class="ttdef"><b>Definition</b> icalmemory.c:370</div></div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="a2f164cb87c67f06b5dc04a5f21384879" name="a2f164cb87c67f06b5dc04a5f21384879"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f164cb87c67f06b5dc04a5f21384879">&#9670;&#160;</a></span>icalmemory_free_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void icalmemory_free_buffer </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Releases a buffer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>The buffer to release </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a9b645edbcc1a05dbb64df5d86adbc367" title="Creates new buffer with the specified size.">icalmemory_new_buffer()</a></dd></dl>
<p>Releases the memory of the buffer.</p>
<p>By default this function delegates to stdlib's free() but the used function can be configured via <a class="el" href="#aeaa82604d4c5ccf150ecd2fb6bfca30d" title="Configures the functions to use for memory management.">icalmemory_set_mem_alloc_funcs()</a>. </p>

</div>
</div>
<a id="a175daa67f089bae6aefd4360fcd0d664" name="a175daa67f089bae6aefd4360fcd0d664"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a175daa67f089bae6aefd4360fcd0d664">&#9670;&#160;</a></span>icalmemory_free_ring()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void icalmemory_free_ring </td>
          <td>(</td>
          <td class="paramtype">void</td>          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Frees all memory used in the ring. </p>
<p>Frees all memory used in the ring. If PTHREAD is used or thread-local mode is configured, the ring buffer is allocated on a per-thread basis, meaning that if all rings are to be released, it must be called once in every thread.</p>
<dl class="section user"><dt>Usage</dt><dd><div class="fragment"><div class="line">c</div>
<div class="line">  <span class="keywordtype">void</span> *buf = <a class="code hl_function" href="#aeaf6a28b3908f695bb0a7e35d1dfc8f7">icalmemory_tmp_buffer</a>(256);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// use buf</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// release buf and all other memory in the ring buffer</span></div>
<div class="line">  <a class="code hl_function" href="#a175daa67f089bae6aefd4360fcd0d664">icalmemory_free_ring</a>();</div>
<div class="ttc" id="aicalmemory_8h_html_a175daa67f089bae6aefd4360fcd0d664"><div class="ttname"><a href="#a175daa67f089bae6aefd4360fcd0d664">icalmemory_free_ring</a></div><div class="ttdeci">void icalmemory_free_ring(void)</div><div class="ttdoc">Frees all memory used in the ring.</div><div class="ttdef"><b>Definition</b> icalmemory.c:215</div></div>
<div class="ttc" id="aicalmemory_8h_html_aeaf6a28b3908f695bb0a7e35d1dfc8f7"><div class="ttname"><a href="#aeaf6a28b3908f695bb0a7e35d1dfc8f7">icalmemory_tmp_buffer</a></div><div class="ttdeci">void * icalmemory_tmp_buffer(size_t size)</div><div class="ttdoc">Creates a new temporary buffer on the ring and returns it.</div><div class="ttdef"><b>Definition</b> icalmemory.c:193</div></div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="ae1659b63eaac2744cae912c727655721" name="ae1659b63eaac2744cae912c727655721"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1659b63eaac2744cae912c727655721">&#9670;&#160;</a></span>icalmemory_get_mem_alloc_funcs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void icalmemory_get_mem_alloc_funcs </td>
          <td>(</td>
          <td class="paramtype">icalmemory_malloc_f *</td>          <td class="paramname"><span class="paramname"><em>f_malloc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">icalmemory_realloc_f *</td>          <td class="paramname"><span class="paramname"><em>f_realloc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">icalmemory_free_f *</td>          <td class="paramname"><span class="paramname"><em>f_free</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the functions used for memory management. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f_malloc</td><td>A pointer to the function to use for memory allocation. </td></tr>
    <tr><td class="paramname">f_realloc</td><td>A pointer to the function to use for memory reallocation. </td></tr>
    <tr><td class="paramname">f_free</td><td>A pointer to the function to use for memory deallocation.</td></tr>
  </table>
  </dd>
</dl>
<p>Retrieves the functions used by the library for memory management. </p><dl class="section since"><dt>Since</dt><dd>4.0 </dd></dl>

</div>
</div>
<a id="a9b645edbcc1a05dbb64df5d86adbc367" name="a9b645edbcc1a05dbb64df5d86adbc367"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b645edbcc1a05dbb64df5d86adbc367">&#9670;&#160;</a></span>icalmemory_new_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * icalmemory_new_buffer </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>size</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates new buffer with the specified size. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>The size of the buffer that is to be created. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the newly-created buffer. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a2f164cb87c67f06b5dc04a5f21384879" title="Releases a buffer.">icalmemory_free_buffer()</a></dd></dl>
<dl class="section user"><dt>Error handling</dt><dd>If there is a problem allocating memory, it sets <a class="el" href="icalerror_8h.html#ad2562706150f5c5a4d9b0ca149d78e37" title="Access the current icalerrno value.">icalerrno</a> to <a class="el" href="icalerror_8h.html#a601c122fcea522513b1b7732fa23e833a055394ffaf6701aa12491dc10767f07d">ICAL_NEWFAILED_ERROR</a> and returns <code>NULL</code>.</dd></dl>
<dl class="section user"><dt>Ownership</dt><dd>Buffers created with this method are owned by the caller. They must be released with the <a class="el" href="#a2f164cb87c67f06b5dc04a5f21384879" title="Releases a buffer.">icalmemory_free_buffer()</a> method.</dd></dl>
<p>This creates a new (non-temporary) buffer of the specified <em class="arg">size</em>. All buffers returned by this method are zeroed-out.</p>
<p>By default this function delegates to stdlib's malloc() but the used function can be changed via <a class="el" href="#aeaa82604d4c5ccf150ecd2fb6bfca30d" title="Configures the functions to use for memory management.">icalmemory_set_mem_alloc_funcs()</a>.</p>
<dl class="section user"><dt>Usage</dt><dd><div class="fragment"><div class="line"><span class="comment">// create buffer</span></div>
<div class="line"><span class="keywordtype">char</span> *buffer = <a class="code hl_function" href="#a9b645edbcc1a05dbb64df5d86adbc367">icalmemory_new_buffer</a>(50);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// fill buffer</span></div>
<div class="line">strcpy(buffer, <span class="stringliteral">&quot;some data&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// release buffer</span></div>
<div class="line"><a class="code hl_function" href="#a2f164cb87c67f06b5dc04a5f21384879">icalmemory_free_buffer</a>(buffer);</div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="a6cf9578649d6f12bf8eae97e4ef537e9" name="a6cf9578649d6f12bf8eae97e4ef537e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cf9578649d6f12bf8eae97e4ef537e9">&#9670;&#160;</a></span>icalmemory_resize_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * icalmemory_resize_buffer </td>
          <td>(</td>
          <td class="paramtype">void *</td>          <td class="paramname"><span class="paramname"><em>buf</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>size</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Resizes a buffer created with <a class="el" href="#a9b645edbcc1a05dbb64df5d86adbc367" title="Creates new buffer with the specified size.">icalmemory_new_buffer()</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buf</td><td>The buffer to be resized. </td></tr>
    <tr><td class="paramname">size</td><td>The new size of the buffer. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The new, resized buffer. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="#a9b645edbcc1a05dbb64df5d86adbc367" title="Creates new buffer with the specified size.">icalmemory_new_buffer()</a> </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>This method may not be used for temporary buffers (buffers allocated with <a class="el" href="#aeaf6a28b3908f695bb0a7e35d1dfc8f7" title="Creates a new temporary buffer on the ring and returns it.">icalmemory_tmp_buffer()</a> and related functions)!</dd></dl>
<dl class="section user"><dt>Error handling</dt><dd>If there is a problem while reallocating the buffer, the method sets <a class="el" href="icalerror_8h.html#ad2562706150f5c5a4d9b0ca149d78e37" title="Access the current icalerrno value.">icalerrno</a> to <a class="el" href="icalerror_8h.html#a601c122fcea522513b1b7732fa23e833a055394ffaf6701aa12491dc10767f07d">ICAL_NEWFAILED_ERROR</a> and returns <code>NULL</code>.</dd></dl>
<dl class="section user"><dt>Ownership</dt><dd>The returned buffer is owned by the caller and needs to be released with the appropriate <a class="el" href="#a2f164cb87c67f06b5dc04a5f21384879" title="Releases a buffer.">icalmemory_free_buffer()</a> method. The old buffer, <em class="arg">buf</em>, can not be used anymore after calling this method.</dd></dl>
<p>By default this function delegates to stdlib's realloc() but the used function can be configured via <a class="el" href="#aeaa82604d4c5ccf150ecd2fb6bfca30d" title="Configures the functions to use for memory management.">icalmemory_set_mem_alloc_funcs()</a>.</p>
<dl class="section user"><dt>Usage</dt><dd><div class="fragment"><div class="line"><span class="comment">// create new buffer</span></div>
<div class="line"><span class="keywordtype">char</span> *buffer = <a class="code hl_function" href="#a9b645edbcc1a05dbb64df5d86adbc367">icalmemory_new_buffer</a>(10);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// fill buffer</span></div>
<div class="line">strcpy(buffer, <span class="stringliteral">&quot;some data&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// expand buffer</span></div>
<div class="line">buffer = <a class="code hl_function" href="#a6cf9578649d6f12bf8eae97e4ef537e9">icalmemory_resize_buffer</a>(buffer, 20);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// fill with more data</span></div>
<div class="line">strcpy(buffer, <span class="stringliteral">&quot;a lot more data&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// release</span></div>
<div class="line"><a class="code hl_function" href="#a2f164cb87c67f06b5dc04a5f21384879">icalmemory_free_buffer</a>(buffer);</div>
<div class="ttc" id="aicalmemory_8h_html_a6cf9578649d6f12bf8eae97e4ef537e9"><div class="ttname"><a href="#a6cf9578649d6f12bf8eae97e4ef537e9">icalmemory_resize_buffer</a></div><div class="ttdeci">void * icalmemory_resize_buffer(void *buf, size_t size)</div><div class="ttdoc">Resizes a buffer created with icalmemory_new_buffer().</div><div class="ttdef"><b>Definition</b> icalmemory.c:341</div></div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="aeaa82604d4c5ccf150ecd2fb6bfca30d" name="aeaa82604d4c5ccf150ecd2fb6bfca30d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeaa82604d4c5ccf150ecd2fb6bfca30d">&#9670;&#160;</a></span>icalmemory_set_mem_alloc_funcs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void icalmemory_set_mem_alloc_funcs </td>
          <td>(</td>
          <td class="paramtype">icalmemory_malloc_f</td>          <td class="paramname"><span class="paramname"><em>f_malloc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">icalmemory_realloc_f</td>          <td class="paramname"><span class="paramname"><em>f_realloc</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">icalmemory_free_f</td>          <td class="paramname"><span class="paramname"><em>f_free</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configures the functions to use for memory management. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">f_malloc</td><td>The function to use for memory allocation. </td></tr>
    <tr><td class="paramname">f_realloc</td><td>The function to use for memory reallocation. </td></tr>
    <tr><td class="paramname">f_free</td><td>The function to use for memory deallocation.</td></tr>
  </table>
  </dd>
</dl>
<p>This function configures the library to use the specified functions for memory management. By default the standard system memory management functions malloc(), realloc() and free() are used.</p>
<p>Note: The memory management functions configured via this functions are used throughout the core libical component but not within other components like libicalvcal. </p><dl class="section since"><dt>Since</dt><dd>4.0 </dd></dl>

</div>
</div>
<a id="a313a5fd91cb6100f9ecc1b8f24acc336" name="a313a5fd91cb6100f9ecc1b8f24acc336"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a313a5fd91cb6100f9ecc1b8f24acc336">&#9670;&#160;</a></span>icalmemory_strdup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * icalmemory_strdup </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>s</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a duplicate of a string. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">s</td><td>The string to duplicate. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to a string containing the same data as <em class="arg">s</em> </dd></dl>
<dl class="section user"><dt>Error handling</dt><dd>The string <em class="arg">s</em> must not be <code>NULL</code>, otherwise depending on the <code>libc</code> used, it might lead to undefined behaviour (read: segfaults).</dd></dl>
<dl class="section user"><dt>Ownership</dt><dd>The returned string is owned by the caller and needs to be released with the <code><a class="el" href="#a2f164cb87c67f06b5dc04a5f21384879" title="Releases a buffer.">icalmemory_free_buffer()</a></code> method.</dd></dl>
<p>Replaces <code>strdup()</code>. The function uses <a class="el" href="#a9b645edbcc1a05dbb64df5d86adbc367" title="Creates new buffer with the specified size.">icalmemory_new_buffer()</a> for memory allocation. It also helps trapping calls to <code>strdup()</code> and solves the problem that in <code>-ansi</code>, <code>gcc</code> on Red Hat claims that <code>strdup()</code> is undeclared.</p>
<dl class="section user"><dt>Usage</dt><dd><div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *my_str = <span class="stringliteral">&quot;LibIcal&quot;</span>;</div>
<div class="line"><span class="keywordtype">char</span> *dup = <a class="code hl_function" href="#a313a5fd91cb6100f9ecc1b8f24acc336">icalmemory_strdup</a>(my_str);</div>
<div class="line">printf(<span class="stringliteral">&quot;%s\n&quot;</span>, dup);</div>
<div class="line"><a class="code hl_function" href="#a2f164cb87c67f06b5dc04a5f21384879">icalmemory_free_buffer</a>(dup);</div>
<div class="ttc" id="aicalmemory_8h_html_a313a5fd91cb6100f9ecc1b8f24acc336"><div class="ttname"><a href="#a313a5fd91cb6100f9ecc1b8f24acc336">icalmemory_strdup</a></div><div class="ttdeci">char * icalmemory_strdup(const char *s)</div><div class="ttdoc">Creates a duplicate of a string.</div><div class="ttdef"><b>Definition</b> icalmemory.c:249</div></div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="aeaf6a28b3908f695bb0a7e35d1dfc8f7" name="aeaf6a28b3908f695bb0a7e35d1dfc8f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeaf6a28b3908f695bb0a7e35d1dfc8f7">&#9670;&#160;</a></span>icalmemory_tmp_buffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void * icalmemory_tmp_buffer </td>
          <td>(</td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>size</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a new temporary buffer on the ring and returns it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">size</td><td>How big (in bytes) the buffer should be </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the newly created buffer on the ring</dd></dl>
<p>Creates a temporary buffer on the ring. Regardless of what <em class="arg">size</em> you specify, the buffer will always be at least MIN_BUFFER_SIZE big, and it will be zeroed out.</p>
<dl class="section user"><dt>Error handling</dt><dd>If there is a problem allocating memory for the buffer, it sets <a class="el" href="icalerror_8h.html#ad2562706150f5c5a4d9b0ca149d78e37" title="Access the current icalerrno value.">icalerrno</a> to <a class="el" href="icalerror_8h.html#a601c122fcea522513b1b7732fa23e833a055394ffaf6701aa12491dc10767f07d">ICAL_NEWFAILED_ERROR</a> and returns <code>NULL</code>.</dd></dl>
<dl class="section user"><dt>Ownership</dt><dd>The returned buffer is owned by icalmemory. It must not be freed by the caller and the returned memory will be automatically reclaimed as more items are added to the ring buffer.</dd></dl>
<dl class="section user"><dt>Usage</dt><dd><div class="fragment"><div class="line"><span class="keywordtype">char</span> *str = <a class="code hl_function" href="#aeaf6a28b3908f695bb0a7e35d1dfc8f7">icalmemory_tmp_buffer</a>(256);</div>
<div class="line">strcpy(str, <span class="stringliteral">&quot;some data&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// use str</span></div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
<a id="aa5f6b34db6cc88a33bd1cd745d44f977" name="aa5f6b34db6cc88a33bd1cd745d44f977"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5f6b34db6cc88a33bd1cd745d44f977">&#9670;&#160;</a></span>icalmemory_tmp_copy()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char * icalmemory_tmp_copy </td>
          <td>(</td>
          <td class="paramtype">const char *</td>          <td class="paramname"><span class="paramname"><em>str</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a copy of the given string, stored on the ring buffer, and returns it. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">str</td><td>The string to copy </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A copy of <em class="arg">str</em>, which has been placed on the ring buffer for automatic reclamation.</dd></dl>
<dl class="section user"><dt>Error handling</dt><dd>The passed string <em class="arg">str</em> must not be <code>NULL</code>, otherwise a segfault might ensue, since the routine calls <code>strlen()</code> on it.</dd></dl>
<dl class="section user"><dt>Ownership</dt><dd>The returned string is owned by icalmemory. It must not be freed by the caller, and it will be automatically reclaimed as more items are added to the buffer.</dd></dl>
<dl class="section user"><dt>Usage</dt><dd><div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">char</span> *str = <span class="stringliteral">&quot;Example string&quot;</span>;</div>
<div class="line"><span class="keywordtype">char</span> *tmp_copy = <a class="code hl_function" href="#aa5f6b34db6cc88a33bd1cd745d44f977">icalmemory_tmp_copy</a>(str);</div>
<div class="ttc" id="aicalmemory_8h_html_aa5f6b34db6cc88a33bd1cd745d44f977"><div class="ttname"><a href="#aa5f6b34db6cc88a33bd1cd745d44f977">icalmemory_tmp_copy</a></div><div class="ttdeci">char * icalmemory_tmp_copy(const char *str)</div><div class="ttdoc">Creates a copy of the given string, stored on the ring buffer, and returns it.</div><div class="ttdef"><b>Definition</b> icalmemory.c:232</div></div>
</div><!-- fragment --> </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Fri May 30 2025 11:51:05 for Libical API Documentation by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2
</small></address>
</div><!-- doc-content -->
</body>
</html>
